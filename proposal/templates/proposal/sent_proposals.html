{% extends 'website/base.html' %}

{% block custom_css %}
<style>

  table {
    -webkit-box-shadow: 0px 2px 5px 2px rgba(168,168,168,1);
    -moz-box-shadow: 0px 2px 5px 2px rgba(168,168,168,1);
    box-shadow: 0px 2px 5px 2px rgba(168,168,168,1);
    margin-top: 50px;
  }
  .heading {
    background-color: black;
    color: white;
    text-align: center;
  }
  .btn-container {
    background-color: #ddd;
  }
  .center {
    text-align: center;
  }
  .fa-plus {
  color white;
  margin-left: 15px;
}
.fa-trash-alt {
  float: right;
  position: relative;
  top: 2px;
  font-size: 25px;
}
h5 {
  text-align:center;
}

</style>
{% endblock custom_css %}

{% block content %}
{% include 'website/server_messages.html' %}
<div class="row">
  <div class="col-sm-10 offset-sm-1">
      <table id="proposal-table" class="table">
        <thead>
      <tr>
        <th colspan="5" class="heading">
          <h2>
            Sent Proposals
            <i class="fas fa-plus" href="{% url 'proposal:add_proposal' %}"></i>
          </h2>
        </th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <th>Name</th>
          <th>Date Added</th>
          <th>Status</th>
        </tr>
        {% for proposal in sent_proposals %}
          <tr id="row-{{proposal.pk}}">
            <td><a href="{% url 'proposal:view_proposal' proposal.pk %}">{{ proposal.name }}</a></td>
            <td>{{ proposal.date_added|date:"M d"}}</td>
            <td>
            <select id="{{ proposal.pk }}" class="status">
              <option value="pending">Pending</option>
              <option value="accepted">Accepted</option>
              <option value="denied">denied</option>
          </select>
          </td>
            <td>
            <i id="{{proposal.pk}}" class="far fa-trash-alt" href="{% url 'proposal:delete_proposal' proposal.pk %}"></i>
            </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
</div>
{% endblock content %}

{% block js %}
<script>
//------------------------------------------------------
// change a proposals status
$('.status').onchange(function(e){
        var status = $(this).data('value');
        var id = $(this).attr('id');
        var url = $(this).attr('href');
        setup_ajax();
        $.ajax({
            type: "POST",
            url: url,
            data:{
              'status': status
              },
            success: function(response) {
                    });
                }
    );
//------------------------------------------------------
</script>
{% endblock js %}
